x-forward-auth: &forward-auth-plugin  
  forward-auth:
    uri: "http://auth-service:8003/auth/verify"
    request_headers:
      - Authorization
    upstream_headers:
      - X-User-UUID
      - X-User-Email
      - X-User-Roles

routes:
  -
    id: httpbin
    uri: /profiles/* # It might be better to move to using subdomains instead of matching based on URIs
    upstream:
      nodes:
        "profile-service:8080": 1 # placeholder
      type: roundrobin
    plugins:
      <<: *forward-auth-plugin
    # strip_uri: true # Ensures the upstream service receives a clean request path without the matching prefix

#END