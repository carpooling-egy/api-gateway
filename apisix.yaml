x-forward-auth: &forward-auth-plugin  
  forward-auth:
    uri: "http://auth-service:8003/auth/verify"
    request_headers:
      - Authorization
    upstream_headers:
      - X-User-UUID
      - X-User-Email
      - X-User-Roles

routes:
  -
    id: profile-api
    uri: /profiles/* # It might be better to move to using subdomains instead of matching based on URIs
    upstream:
      nodes:
        "profile-service:8080": 1 # placeholder for port
      type: roundrobin
    plugins:
      <<: *forward-auth-plugin
    # strip_uri: true # Ensures the upstream service receives a clean request path without the matching prefix

  -
    id: trip-management-api
    uri: /trip/* # It might be better to move to using subdomains instead of matching based on URIs
    upstream:
      nodes:
        "trip-management-service:8081": 1 # placeholder for port
      type: roundrobin
    plugins:
      <<: *forward-auth-plugin
    strip_uri: true # Ensures the upstream service receives a clean request path without the matching prefix


  -
    id: request-management-api
    uri: /request/* # It might be better to move to using subdomains instead of matching based on URIs
    upstream:
      nodes:
        "request-management-service:8082": 1 # placeholder for port
      type: roundrobin
    plugins:
      <<: *forward-auth-plugin
    strip_uri: true # Ensures the upstream service receives a clean request path without the matching prefix

#END